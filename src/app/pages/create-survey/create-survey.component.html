<div class="create-survey-container" *ngIf="!loading; else loadingTpl">
  
  <!-- ูุฏุฑ ุตูุญู -->
  <div class="survey-header-section">
    <div class="header-content">
      <div class="page-title">
        <h1>๐ ุงุฌุงุฏ ูุธุฑุณูุฌ ุฌุฏุฏ</h1>
        <div class="page-subtitle">
          ุดูุงุณู ุฏุฑุณ: {{ convertToPersianNumbers(courseId || '') }}
        </div>
      </div>
      <button class="back-btn" (click)="goBack()">โ ุจุงุฒฺฏุดุช ุจู ุฏุฑุณ</button>
    </div>
  </div>

  <!-- ูุฑู ุงุฌุงุฏ ูุธุฑุณูุฌ -->
  <div class="survey-form-card">
    
    <!-- ุนููุงู ูุธุฑุณูุฌ -->
    <div class="form-group">
      <label class="form-label">
        <span class="label-icon">๐</span>
        ุนููุงู ูุธุฑุณูุฌ
      </label>
      <input 
        type="text" 
        class="form-input" 
        [(ngModel)]="surveyData.title"
        placeholder="ูุซุงู: ฺฉุฏุงู ุชุงุฑุฎ ุจุฑุง ุงูุชุญุงู ููุงุณุจโุชุฑ ุงุณุชุ"
        maxlength="200"
        autocomplete="off"
      >
      <div class="form-hint" style="margin-top: 8px; font-size: 13px; color: #6b7280;">
        ฺฉ ุนููุงู ูุงุถุญ ู ุชูุตู ุจุฑุง ูุธุฑุณูุฌ ูุงุฑุฏ ฺฉูุฏ (ุญุฏุงูู ต ุญุฑู)
      </div>
    </div>

    <!-- ฺฏุฒููโูุง ูุธุฑุณูุฌ -->
    <div class="form-group">
      <div class="options-section">
        <div class="options-header">
          <h3 class="options-title">๐ ฺฏุฒููโูุง ูุธุฑุณูุฌ</h3>
          <button class="add-option-btn" (click)="addOption()" type="button">
            <span>+</span>
            ุงูุฒูุฏู ฺฏุฒูู ุฌุฏุฏ
          </button>
        </div>

        <div class="options-list">
          <div 
            *ngFor="let option of surveyData.options; let i = index; trackBy: trackByOptionId" 
            class="option-item"
          >
            <div class="option-number">{{ convertToPersianNumbers((i + 1).toString()) }}</div>
            <input 
              type="text" 
              class="option-input" 
              [(ngModel)]="option.text"
              [placeholder]="'ฺฏุฒูู ' + convertToPersianNumbers((i + 1).toString())"
              maxlength="100"
              autocomplete="off"
            >
            <button 
              class="remove-option-btn"
              (click)="removeOption(i)"
              [disabled]="surveyData.options.length <= 2"
              title="ุญุฐู ุงู ฺฏุฒูู"
              type="button"
            >
              โ
            </button>
          </div>
        </div>

        <div class="form-hint" style="margin-top: 16px; font-size: 13px; color: #6b7280;">
          โข ุญุฏุงูู ฒ ฺฏุฒูู ูุงุฒ ุงุณุช<br>
          โข ฺฏุฒููโูุง ุจุงุฏ ูุงุถุญ ู ูุฎุชุตุฑ ุจุงุดูุฏ (ฒ ุชุง ฑฐฐ ุญุฑู)<br>
          โข ฺฏุฒููโูุง ูุจุงุฏ ุชฺฉุฑุงุฑ ุจุงุดูุฏ
        </div>
      </div>
    </div>

    <!-- ุฏฺฉููโูุง ุนููุงุช -->
    <div class="form-actions">
      <button class="cancel-btn" (click)="goBack()" type="button" [disabled]="loading">ูุบู</button>
      <button 
        class="submit-btn" 
        (click)="submitSurvey()"
        [disabled]="loading || isSubmitted"
        type="button"
      >
        <span *ngIf="!loading">โ</span>
        <span *ngIf="loading">โณ</span>
        {{ loading ? 'ุฏุฑ ุญุงู ุงุฌุงุฏ...' : 'ุงุฌุงุฏ ูุธุฑุณูุฌ' }}
      </button>
    </div>

    <!-- ูพุงู ุฎุทุง -->
    <div *ngIf="errorMessage" class="message-container error-message">
      <div style="display: flex; align-items: center; gap: 8px;">
        <span>โ๏ธ</span>
        <span>{{ errorMessage }}</span>
      </div>
    </div>

    <!-- ูพุงู ููููุช -->
    <div *ngIf="successMessage" class="message-container success-message">
      <div style="display: flex; align-items: center; gap: 8px;">
        <span>๐</span>
        <div>
          <strong>{{ successMessage }}</strong>
          <div style="font-size: 14px; margin-top: 4px;">
            ุฏุฑ ุญุงู ุจุงุฒฺฏุดุช ุจู ุตูุญู ุฏุฑุณ...
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- ููุฏูฺฏ -->
<ng-template #loadingTpl>
  <div class="loading-overlay">
    <div class="loading-content">
      <div class="spinner"></div>
      <p class="loading-text">ุฏุฑ ุญุงู ุงุฌุงุฏ ูุธุฑุณูุฌ...</p>
    </div>
  </div>
</ng-template>